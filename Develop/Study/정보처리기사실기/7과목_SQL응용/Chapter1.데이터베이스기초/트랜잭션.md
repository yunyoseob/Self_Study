## 정보처리기사 실기

## Chapter01. 데이터베이스 기초

## 01. 트랜잭션

<hr>

**✔ 트랜잭션**

데이터베이스 시스템에서 하나의 논리적 기능을 정상적으로 수행하기 위한 작업의 기본단위

**✔ 트랜잭션의 특성**

```
// ACID

Atomicity : 원자성

Consistency : 일관성

Isolation : 격리성 = 고립성

Durability : 영속성
```

**✔ 원자성(Atomicity)**

- 트랜잭션을 구성하는 연산 전체가 모두 정상적으로 실행되거나 모두 취소되어야 하는 성질

- 트랜잭션의 연산 자체가 성공 또는 실패(All or Nothing)되어야 하는 성질

**✔ 일관성(Consistency)**

- 시스템이 가지고 있는 고정요소는 트랜잭션 수행 전과 트랜잭션 수행 완료 후의 상태가 같아야 하는 성질

**✔ 격리성(혹은 고립성, Isolation)**

- 동시에 실행되는 트랜잭션들이 서로 영향을 미치지 않아야 한다는 성질

**✔ 영속성(Durability)**

성공이 완료된 트랜잭션의 결과는 영속적으로 데이터베이스에 저장되어야 하는 성질

### 트랜잭션의 상태변화

```
// 활부 완실철

활동(Active)

부분 완료(Partially Committed)

완료 상태(Commited)

실패 상태(Failed)

철회 상태(Aborted)
```

### 트랜잭션 제어 언어

트랜잭션 제어언어는 TCL(Transaction Control Language)이라고 하며, 트랜잭션의 결과를 허용하거나 취소하는 목적으로 사용되는 언어를 지정

**✔ TCL 명령어**

```
// 커롤체

커밋(Commit)

롤백(Rollback)

체크포인트(Checkpoint or Savepoint)
```

### 병행 제어

병행 제어는 다수 사용자 환경에서 여러 트랜잭션을 수행할 때, 데이터베이스 일관성 유지를 위해 상호작용을 제어하는 기법

**✔ 병행 제어 미보장 시 문제점**

```
// 갱현모연

갱신손실(Lost Update) : 먼저 실행된 트랜잭션의 결과를 나중에 실행된 트랜잭션이 덮어쓸 때 발생하는 오류

현황 파악 오류(Dirty Read) : 트랜잭션의 중간 수행 결과를 다른 트랜잭션이 참조하여 발생하는 오류

모순성 (Inconsistency) : 두 트랜잭션이 동시에 실행되어 데이터베이스의 일관성이 결여되는 오류

연쇄복귀(Cascading Rollback) : 복수의 트랜잭션이 데이터 공유 시 특정 트랜잭션이 처리를 취소할 경우 트랜잭션이 처리한 곳의 부분을 취소하지 못하는 오류
```

### 병행 제어 기법

- 로 낙타다

|기법|설명|
|:--|:--|
|로킹(Locking)|- 같은 자원을 액세스하는 다중 트랜잭션 환경에서 DB의 **일관성**과 **무결성**을 유지하기 위해 **트랜잭션의 순차적 진행**을 **보장**하는 **직렬화 기법** <br> - 로킹 단위가 적으면 로킹 오버헤드가 증가(로크를 많이 걸어야 하기 때문, 제어가 어렵다, 그래도 병행성 증가)|
|낙관적 검증(Optimistic Validation)|- 트랜잭션이 **어떠한 검증도 수행하지 않고** 일단 트랜잭션을 수행하고, 트랜잭션 종료 시 검증을 수행하여 데이터베이스에 반영하는 기법(읽기(Read)->검증(Validation)->쓰기(Write)|
|타임 스탬프 순서(Time Stamp Ordering)|- 트랜잭션과 트랜잭션이 읽거나 갱신한 데이터에 대해 트랜잭션이 실행을 시작하기 전에 타임 스탬프(Time Stamp)를 부여하여 부여된 시간에 따라 트랜잭션 작업을 수행하는 기법|
|다중버전 동시성 제어(MVCC : Multi Version Concurrency Control)|- 트랜잭션의 타임스탬프와 접근하려는 데이터의 타임스탬프를 비교하여 직렬가능성이 보장되는 적절한 버전을 선택하여 접근하도록 하는 기법|

### 고립화 수준(Isolation Level)

고립화 수준은 다른 트랜잭션이 현재의 데이터에 대한 **무결성**을 해치지 않기 위해 잠금을 설정하는 정도

**✔ 고립화 수준 종류**

```
// RRRS

Read unCommitted : 한 트랜잭션에서 연산(갱신) 중인 (아직 커밋되지 않은) 데이터를 다른 트랜잭션이 읽는 것을 허용하는 수준

Read Committed : 한 트랜잭션에서 연산(갱신)을 수행할 때, 연산이 완료될 때까지 연산 대상 데이터에 대한 읽기를 제한하는 수준

Repeatable Read : 선행 트랜잭션이 특정 데이터를 읽을 때, 트랜잭션 종료 시까지 해당 데이터에 대한 갱신 삭제를 제한하는 수준

Serializable Read : 선행 트랜잭션이 특정 데이터 영역을 순차적으로 읽을 때, 해당 데이터 영역 전체에 대한 접근 제한하는 수준
```

### 회복(Recovery) 기법 개념

회복 기법은 트랜잭션을 수행하는 도중 장애로 인해 손상된 데이터베이스를 손상되기 이전에 정상적인 상태로 복구시키는 작업 (되돌리는 작업)

**✔ 회복 기법 종류**

```
// 회로 체그

회복 기법

- 로그 기반 회복 기법 : 지연 갱신 기법(트랜잭션이 완료되기 전까지 데이터베이스에 기록하지 않는 기법), 즉시 갱신 기법(트랜잭션 수행 중 갱신 결과를 바로 DB에 반영하는 기법)

- 체크 포인트 회복 기법 : 장애 발생 시 검사점 이후에 처리된 트랜잭션에 대해서만 장애 발생 이전의 상태로 복원시키는 회복 기법

- 그림자 페이징 회복 기법 : 데이터베이스 트랜잭션 수행 시 복제본을 생성하여 데이터베이스 장애 시 이를 이용해 복구하는 기법
```